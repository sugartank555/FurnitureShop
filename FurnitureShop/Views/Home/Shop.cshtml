@using FurnitureShop.Models
@{
    ViewData["Title"] = "Cửa hàng";
    var products = Model as IEnumerable<Product>;
    var categories = ViewBag.Categories as IEnumerable<Category>;
    string currentCategory = ViewBag.CategoryId?.ToString() ?? "";
    string priceRange = ViewBag.PriceRange ?? "";
    string brand = ViewBag.Brand ?? "";
    string search = ViewBag.Search ?? "";
}

<div class="container my-4">
    <h2 class="fw-bold text-center mb-4">🛋️ Cửa hàng nội thất</h2>

    <!-- 🔹 Bộ lọc và tìm kiếm -->
    <form method="get" asp-action="Shop" class="row g-3 mb-4">
        <!-- Tên sản phẩm -->
        

        <!-- Danh mục -->
        <div class="col-md-3">
            <select class="form-select" name="categoryId">
                <option value="">Tất cả danh mục</option>
                @foreach (var cat in categories ?? Enumerable.Empty<Category>())
                {
                    if (cat.Id.ToString() == currentCategory)
                    {
                        <option value="@cat.Id" selected>@cat.Name</option>
                    }
                    else
                    {
                        <option value="@cat.Id">@cat.Name</option>
                    }
                }
            </select>
        </div>

        <!-- Giá -->
        <div class="col-md-2">
            <select class="form-select" name="priceRange">
                <option value="">Tất cả giá</option>
                <option value="low" selected="@(priceRange == "low")">Dưới 1.000.000đ</option>
                <option value="mid" selected="@(priceRange == "mid")">1.000.000đ - 5.000.000đ</option>
                <option value="high" selected="@(priceRange == "high")">Trên 5.000.000đ</option>
            </select>
        </div>
        <div class="col-md-3">
            <input type="text" name="search" value="@search" class="form-control" placeholder="🔍 Tìm theo tên sản phẩm..." />
        </div>
     
        <!-- Nút lọc -->
        <div class="col-md-2 d-grid">
            <button type="submit" class="btn btn-primary fw-bold">Lọc / Tìm</button>
        </div>
    </form>

    <!-- 🔹 Danh sách sản phẩm -->
    <div class="row">
        @if (products != null && products.Any())
        {
            @foreach (var p in products)
            {
                <div class="col-md-4 mb-4">
                    <div class="card h-100 shadow-sm border-0 hover-shadow">
                        <img src="@p.ImageUrl" class="card-img-top" alt="@p.Name" />
                        <div class="card-body text-center">
                            <h5 class="card-title">@p.Name</h5>
                            <p class="text-danger fw-bold">@p.Price.ToString("N0") đ</p>
                            <a href="/Home/Details/@p.Id" class="btn btn-outline-primary">Xem chi tiết</a>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="text-center py-5">
                <p class="text-muted fs-5">Không tìm thấy sản phẩm phù hợp với tiêu chí tìm kiếm của bạn.</p>
            </div>
        }
    </div>
</div>
